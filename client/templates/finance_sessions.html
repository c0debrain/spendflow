<template name="financeSessions">
  <div class="help">
    <p>You should create a new Session whenever you want to take notes about your finances.</p>
    <p>Kevin uses this
    to create text-based checklists ([] Like this) so he can remember what he was doing if he has to step away. He also
    takes notes about things he might have to follow up on in the next Session.</p>
  </div>

  {{> newFinanceSessionForm}}
  {{> financeSessionList}}
</template>

<template name="financeSessionList">
  <div class="finance-session-list record-list">
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>Date</th>
          <th>Notes</th>
          <th>&nbsp;</th>
        </tr>
      </thead>
      <tbody>
        {{#each financeSessions}}
          {{> financeSession}}
        {{/each}}
      </tbody>
    </table>
  </div>
</template>

<template name="editSession">
  {{#with editingFinanceSession}}
    <fieldset>
      {{> financeSessionForm}}
    </fieldset>
  {{/with}}
</template>

<template name="financeSession">
  <tr data-target="{{_id}}"{{#if thisRowBeingEdited}} class="being-edited"{{/if}}>
    <td>{{startDate}}</td>
    <td>{{multiline notesTeaser}}</td>
    <td><a href="{{editSessionUrl profileId _id}}" class="edit-finance-session"><i class="icon-pencil"></i></a> <a href="#" class="remove-finance-session"><i class="icon-trash"></i></a></td>
  </tr>
</template>

<template name="newFinanceSessionForm">
  <div class="btn-toolbar">
    <button class="btn btn-large new-finance-session-trigger" data-toggle="collapse"
            data-target="#new-finance-session-form"><i
      class="icon-plus"></i> New Session
    </button>
  </div>
  <div id="new-finance-session-form" class="collapse{{#unless financeSessionsCount}} in{{/unless}}">
    {{> financeSessionForm}}
  </div>
</template>

<template name="financeSessionForm">
  <form id="finance-session-form{{#if _id}}-{{_id}}{{/if}}" {{#if _id}} class="edit-record-form" data-target="{{_id}}"{{else}} class="add-record-form"{{/if}}>
    <label>Start date of Session (e.g. today)</label>
    <input type="text" name="startDate"{{#if _id}} value="{{startDate}}"{{/if}} />

    {{#if _id}}
      {{! So if we resize the textbox it doesn't jump back to how it was when we save}}
      {{#isolate}}
        <label>Your notes</label>
        <textarea class="notes" name="notes">{{notes}}</textarea>
      {{/isolate}}
    {{else}}
      <label>Your notes</label>
      <textarea class="notes" name="notes"></textarea>
    {{/if}}

    <div class="control-group">
      <button type="submit" class="btn {{#if _id}}save-finance-session{{else}}add-finance-session{{/if}}">{{#if _id}}Save{{else}}Add{{/if}}</button>
      <a href="{{sessionsUrl profileId}}">Go back</a>
    </div>
  </form>
</template>
